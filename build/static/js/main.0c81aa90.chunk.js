(this["webpackJsonpskull-web-react"]=this["webpackJsonpskull-web-react"]||[]).push([[0],{50:function(e,n,a){e.exports=a(92)},88:function(e,n){},91:function(e,n,a){},92:function(e,n,a){"use strict";a.r(n);var t=a(0),r=a.n(t),c=a(16),o=a(47),l=a(3),i=a(17),u=a(31),s=a(10),m=a(13),d=["red","orange","blue","green","purple","yellow"],p=["rose","skull"],f=Object(m.a)(Array(24).keys()).map((function(e){return{id:"card_".concat(e),color:d[Math.floor(e/4)],type:p[e%4===0?1:0],is_flipped:!1}})),v=Object(m.a)(Array(6).keys()).map((function(e){return{id:"mat_".concat(e),color:d[e],is_flipped:!1}})),b={discards:[],players:[null,null,{name:"Test Name",color:d[2]},null,null,null],cards:f.reduce((function(e,n){return Object.assign({},e,Object(s.a)({},n.id,n))}),{}),hands:[f.slice(0,4).map((function(e){return e.id})),f.slice(4,8).map((function(e){return e.id})),f.slice(8,12).map((function(e){return e.id})),f.slice(12,16).map((function(e){return e.id})),f.slice(16,20).map((function(e){return e.id})),f.slice(20,24).map((function(e){return e.id}))],mats:v.reduce((function(e,n){return Object.assign({},e,Object(s.a)({},n.id,n))}),{}),stacks:Array(6).fill([])},y=function(e){return function(n){return null===n||n===e?null:n}},E=function(e){return function(n){return n!==e}},g=Object(u.a)(/player\x2D([0-9])\x2Dstack/,{player_number:1}),h=Object(u.a)(/player\x2D([0-9])\x2Dhand\x2D([0-9])/,{player_number:1,hand_position:2}),_=function(){var e,n,a,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,c=arguments.length>1?arguments[1]:void 0,o=c.player_number,l=c.name,u=c.card_id,s=c.to_position,m=c.mat_id;switch(c.type){case"REPLACE":return Object.assign({},r,Object(i.a)({},c.game));case"ADD_PLAYER":return(t=r.players)[o]={name:l,color:d[o]},Object.assign({},r,{players:t});case"REMOVE_PLAYER":return(t=r.players)[o]=null,Object.assign({},r,{players:t});case"FLIP_CARD":var p=r.cards;return p[u].is_flipped=!p[u].is_flipped,Object.assign({},r,{cards:p});case"MOVE_CARD":if(console.log("MOVE_CARD",u,"to",s),e=r.discards.filter(E(u)),n=r.hands.map((function(e){return e.map(y(u))})),a=r.stacks.map((function(e){return e.filter(E(u))})),s.includes("discard"))e.findIndex((function(e){return null===e})),e.push(u);else if(s.includes("stack")){var f=s.match(g).groups.player_number;console.log("player_number",f),a[f].push(u)}else if(s.includes("hand")){var _=s.match(h).groups,O=_.player_number,C=_.hand_position;n[O][C]=u}else console.error("Could not move card ".concat(u," to ").concat(s));return console.log("stacks =",a),Object.assign({},r,{discards:e,hands:n,stacks:a});case"FLIP_MAT":return Object.assign({},r,{mats:v.map((function(e){return e.id===m&&(e.is_flipped=!e.is_flipped),e}))});default:return r}},O={name:null,player_number:null},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,n=arguments.length>1?arguments[1]:void 0,a=n.name,t=n.player_number;switch(n.type){case"SET_NAME":return Object.assign({},e,{name:a});case"ADD_PLAYER":return a===e.name?Object.assign({},e,{player_number:t}):e;case"REMOVE_PLAYER":return t===e.player_number?Object.assign({},e,{player_number:null}):e;default:return e}},D={members:[]},j=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,a=arguments.length>1?arguments[1]:void 0,t=a.name;switch(a.type){case"REPLACE":return Object.assign({},n,Object(i.a)({},a.room));case"ADD_MEMBER":return(e=n.members).push(t),Object.assign({},n,{members:e});case"REMOVE_MEMBER":return e=n.members.filter((function(e){return e!==t})),Object.assign({},n,{members:e});default:return n}},k=Object(l.c)({game:_,me:C,room:j}),N=a(7),A=a(8),M=a(9),R=a(2),P=a(12),w=a(11),S=function(e){var n=e.position,a=e.moveCard;return r.a.createElement("div",{className:"card null",onDrop:function(e){e.preventDefault();var t=e.dataTransfer.getData("draggable_id");a(t,n)},onDragOver:function(e){return e.preventDefault()}})},L=function(e){var n=e.id,a=e.color,t=(e.type,e.is_flipped),c=e.flipCard;return r.a.createElement("div",{className:"card ".concat(a),id:n,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("draggable_id",e.target.id)},onDoubleClick:function(){c(n)}},t?"F":"N")},x=function(e){var n=e.position,a=e.card,t=e.moveCard,c=e.flipCard;return null===a?r.a.createElement(S,{position:n,moveCard:t}):r.a.createElement(L,Object.assign({},a,{flipCard:c}))},T=function(e){var n=e.cards;return r.a.createElement("div",{className:"cards"},n.map((function(e){return r.a.createElement(x,{card:e,key:e.id})})))},V=function(e){Object(R.a)(a,e);var n=Object(M.a)(a);function a(){return Object(N.a)(this,a),n.apply(this,arguments)}return Object(A.a)(a,[{key:"componentDidMount",value:function(){console.log("CardsContainer.componentDidMount")}},{key:"render",value:function(){var e=this.props.cards;return r.a.createElement(T,{cards:e})}}]),a}(r.a.Component);V=Object(P.b)((function(e){var n=e.cards,a=n.items,t=n.item_ids;return{cards:Object(m.a)(t).map((function(e){return a[e]}))}}))(V);var I=function(e){var n=e.discards,a=e.moveCard,t=e.flipCard;return r.a.createElement("div",{id:"discards-container"},r.a.createElement("h2",null,"Discards"),r.a.createElement("div",{id:"discards",onDrop:function(e){e.preventDefault();var n=e.dataTransfer.getData("draggable_id");a(n,"discard")},onDragOver:function(e){return e.preventDefault()}},n.map((function(e,n){return r.a.createElement(x,{card:e,key:n,position:"discard-".concat(n),moveCard:a,flipCard:t})}))))},Y=function(e){var n=e.player_number,a=e.cards,t=e.moveCard,c=e.flipCard;return r.a.createElement("div",{className:"hand"},a.map((function(e,a){return r.a.createElement(x,{card:e,key:a,position:"player-".concat(n,"-hand-").concat(a),moveCard:t,flipCard:c})})))},G=function(e){var n=e.player_number,a=e.cards,t=e.moveCard,c=e.flipCard;return r.a.createElement("div",{className:"stack",onDrop:function(e){e.preventDefault();var a=e.dataTransfer.getData("draggable_id"),r="player-".concat(n,"-stack");console.log("move card",a,"to",r),t(a,r)},onDragOver:function(e){return e.preventDefault()}},a.map((function(e,a){return r.a.createElement(x,{card:e,key:a,position:"player-".concat(n,"-stack"),moveCard:t,flipCard:c})})))},B=function(e){return null===e.player?r.a.createElement(F,e):r.a.createElement(z,e)},F=function(e){var n=e.player_number,a=(e.player,e.me),t=e.addPlayer;return r.a.createElement("div",{id:"player-{$player_number}",className:"player"},null!==a.name&&null===a.player_number&&r.a.createElement("button",{onClick:function(){null!==a.name&&(console.log("Sitting down at position",n),t(n,a.name))}},"Sit Down"))},z=function(e){var n=e.player_number,a=e.player,t=e.me,c=e.removePlayer;return r.a.createElement("div",{id:"player-{$player_number}",className:"player ".concat(a.color)},r.a.createElement("div",{className:"info"},a.name),null!==t.player_number&&n===t.player_number&&r.a.createElement("button",{onClick:function(){console.log("Stand up from position",n),c(n)}},"Stand Up"))},$=function(e){Object(R.a)(a,e);var n=Object(M.a)(a);function a(e){var t;return Object(N.a)(this,a),(t=n.call(this,e)).onChangeName=t.onChangeName.bind(Object(w.a)(t)),t.enterGame=t.enterGame.bind(Object(w.a)(t)),t.state={name:"",error:null},t}return Object(A.a)(a,[{key:"componentDidMount",value:function(){console.log("GetName.componentDidMount()")}},{key:"onChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"enterGame",value:function(){var e=this.state.name;e.length<2?this.setState({error:"Name must be at least two characters"}):/[a-z]+$/.test(e)?this.props.setName(e):this.setState({error:"Name must be only [a-z] characters"})}},{key:"render",value:function(){this.props.setName;var e=this.state,n=e.name,a=e.error;return r.a.createElement("div",null,r.a.createElement("h1",null,"Skull"),r.a.createElement("h3",null,"It is always a skull"),r.a.createElement("div",{id:"set-name"},r.a.createElement("p",null,"Enter your name (only use [a-z])"),r.a.createElement("input",{type:"text",value:n,onChange:this.onChangeName}),r.a.createElement("button",{onClick:this.enterGame},"Enter"),a&&r.a.createElement("div",{className:"error"},a)))}}]),a}(r.a.Component),J=function(e){var n=e.me,a=e.room,t=e.game,c=e.moveCard,o=e.flipCard,l=e.addPlayer,i=e.removePlayer,u=e.setName;if(null===n.name)return r.a.createElement($,{setName:u});var s=t.discards,m=t.players,d=t.cards,p=t.hands,f=(t.mats,t.stacks);return s=s.map((function(e){return null===e?null:d[e]})),p=p.map((function(e){return e=e.map((function(e){return null===e?null:d[e]}))})),f=f.map((function(e){return e=e.map((function(e){return null===e?null:d[e]}))})),r.a.createElement("div",{id:"app"},r.a.createElement("div",{className:"main"},r.a.createElement("div",{id:"players-container"},r.a.createElement("h2",null,"Players"),r.a.createElement("div",{id:"players"},m.map((function(e,a){return r.a.createElement(B,{player:e,me:n,addPlayer:l,removePlayer:i,player_number:a,key:a})})))),r.a.createElement("div",{id:"hands-container"},r.a.createElement("h2",null,"Hands"),r.a.createElement("div",{id:"hands"},p.map((function(e,n){return r.a.createElement(Y,{cards:e,moveCard:c,flipCard:o,player_number:n,key:n})})))),r.a.createElement("div",{id:"stacks-container"},r.a.createElement("h2",null,"Stacks"),r.a.createElement("div",{id:"stacks"},f.map((function(e,n){return r.a.createElement(G,{cards:e,moveCard:c,flipCard:o,player_number:n,key:n})}))))),r.a.createElement(I,{discards:s,moveCard:c,flipCard:o}),r.a.createElement("div",{id:"room-container"},r.a.createElement("h2",null,"Room"),r.a.createElement("ul",null,a.members.map((function(e){return r.a.createElement("li",null,r.a.createElement("span",null,e))})))))},H=a(49),U=a.n(H)()(window.location.href);U.on("message",(function(e){console.log("got message"),console.log(e)})),U.on("action",(function(e){console.log("received action",e),X.dispatch(e)})),window.onbeforeunload=function(){U.disconnect()};var q=U,K=function(e){Object(R.a)(a,e);var n=Object(M.a)(a);function a(e){return Object(N.a)(this,a),n.call(this,e)}return Object(A.a)(a,[{key:"componentDidMount",value:function(){console.log("Container.componentDidMount")}},{key:"render",value:function(){return console.log("Container props=",this.props),r.a.createElement(J,this.props)}}]),a}(r.a.Component);K=Object(P.b)((function(e){return e}),(function(e){return{moveCard:function(n,a){return e(function(e,n){return function(a){var t={type:"MOVE_CARD",card_id:e,to_position:n};q.emit("action",t),a(t)}}(n,a))},flipCard:function(n){return e(function(e){return function(n){var a={type:"FLIP_CARD",card_id:e};q.emit("action",a),n(a)}}(n))},addPlayer:function(n,a){return e(function(e,n){return function(a){var t={type:"ADD_PLAYER",player_number:e,name:n};q.emit("action",t),a(t)}}(n,a))},removePlayer:function(n){return e(function(e){return function(n){var a={type:"REMOVE_PLAYER",player_number:e};q.emit("action",a),n(a)}}(n))},setName:function(n){return e(function(e){return function(n){var a={type:"SET_NAME",name:e};q.emit("action",a),n(a),n({type:"ADD_MEMBER",name:e})}}(n))}}}))(K);var Q=function(e){var n=e.store;return r.a.createElement(P.a,{store:n},r.a.createElement(K,null))},W=(a(91),Object(l.d)(k,Object(l.a)(o.a,(function(e){return function(e){return function(n){return console.log("logging action =",n),e(n)}}}))));Object(c.render)(r.a.createElement(Q,{store:W}),document.getElementById("root"));var X=n.default=W}},[[50,1,2]]]);
//# sourceMappingURL=main.0c81aa90.chunk.js.map